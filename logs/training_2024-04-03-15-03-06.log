2024-04-03 15:03:06,141 - INFO - Args parsed succesfully
2024-04-03 15:03:06,141 - INFO - Params: Namespace(emotion_transform_prob=0.0, epochs=20, exp_name='Regular_Few_Epochs', fine_tune=True, load_byol=False, net_name='resnet18', use_expanded_dataset=False, verbose=False)
2024-04-03 15:03:06,469 - INFO - Model was initialized and sent to cuda:0
2024-04-03 15:03:06,470 - INFO - EmotionNet(
  (nn_model): ResNet(
    (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu): ReLU(inplace=True)
    (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
    (layer1): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (1): BasicBlock(
        (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer2): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer3): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (layer4): Sequential(
      (0): BasicBlock(
        (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (downsample): Sequential(
          (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (1): BasicBlock(
        (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (relu): ReLU(inplace=True)
        (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
    (fc): Linear(in_features=512, out_features=7, bias=True)
  )
)
2024-04-03 15:03:08,114 - INFO - All data has been loaded
2024-04-03 15:03:08,115 - INFO - Got hyper parametrs for current model:
2024-04-03 15:03:08,115 - INFO - batch size=128
2024-04-03 15:03:08,115 - INFO - Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0002
    lr: 0.0002
    maximize: False
    weight_decay: 2e-05
)
2024-04-03 15:03:08,115 - INFO - <torch.optim.lr_scheduler.CosineAnnealingLR object at 0x7fc12cf14700>
2024-04-03 15:03:08,116 - INFO - DataLoaders initialized
2024-04-03 15:03:08,116 - INFO - HyperParams initiliazed, starting training...
2024-04-03 15:04:23,169 - INFO - Epoch: 1 | Loss: 0.0112 | Validation accuracy: 58.345% | Epoch Time: 75.05 secs
2024-04-03 15:05:38,937 - INFO - Epoch: 2 | Loss: 0.0097 | Validation accuracy: 61.856% | Epoch Time: 75.47 secs
2024-04-03 15:06:56,340 - INFO - Epoch: 3 | Loss: 0.0092 | Validation accuracy: 61.159% | Epoch Time: 76.03 secs
2024-04-03 15:08:12,220 - INFO - Epoch: 4 | Loss: 0.0088 | Validation accuracy: 64.475% | Epoch Time: 75.44 secs
2024-04-03 15:10:20,689 - INFO - Epoch: 5 | Loss: 0.0085 | Training accuracy: 60.521% | Validation accuracy: 65.784% | Epoch Time: 127.26 secs
2024-04-03 15:11:37,732 - INFO - Epoch: 6 | Loss: 0.0083 | Validation accuracy: 64.921% | Epoch Time: 75.70 secs
2024-04-03 15:12:54,485 - INFO - Epoch: 7 | Loss: 0.0080 | Validation accuracy: 65.729% | Epoch Time: 76.06 secs
2024-04-03 15:14:10,823 - INFO - Epoch: 8 | Loss: 0.0078 | Validation accuracy: 68.403% | Epoch Time: 75.90 secs
2024-04-03 15:15:27,923 - INFO - Epoch: 9 | Loss: 0.0076 | Validation accuracy: 67.540% | Epoch Time: 76.00 secs
2024-04-03 15:17:35,877 - INFO - Epoch: 10 | Loss: 0.0073 | Training accuracy: 64.008% | Validation accuracy: 67.707% | Epoch Time: 127.27 secs
2024-04-03 15:18:52,338 - INFO - Epoch: 11 | Loss: 0.0072 | Validation accuracy: 67.930% | Epoch Time: 76.04 secs
2024-04-03 15:20:09,058 - INFO - Epoch: 12 | Loss: 0.0069 | Validation accuracy: 69.295% | Epoch Time: 76.16 secs
2024-04-03 15:21:26,509 - INFO - Epoch: 13 | Loss: 0.0067 | Validation accuracy: 68.933% | Epoch Time: 76.04 secs
2024-04-03 15:22:43,620 - INFO - Epoch: 14 | Loss: 0.0065 | Validation accuracy: 70.020% | Epoch Time: 76.53 secs
2024-04-03 15:24:55,381 - INFO - Epoch: 15 | Loss: 0.0062 | Training accuracy: 71.354% | Validation accuracy: 70.242% | Epoch Time: 130.57 secs
2024-04-03 15:26:16,943 - INFO - Epoch: 16 | Loss: 0.0061 | Validation accuracy: 70.828% | Epoch Time: 80.51 secs
2024-04-03 15:27:36,034 - INFO - Epoch: 17 | Loss: 0.0059 | Validation accuracy: 70.883% | Epoch Time: 77.86 secs
2024-04-03 15:28:54,801 - INFO - Epoch: 18 | Loss: 0.0058 | Validation accuracy: 71.552% | Epoch Time: 77.29 secs
2024-04-03 15:30:16,149 - INFO - Epoch: 19 | Loss: 0.0057 | Validation accuracy: 71.552% | Epoch Time: 79.80 secs
2024-04-03 15:32:27,820 - INFO - Epoch: 20 | Loss: 0.0057 | Training accuracy: 73.834% | Validation accuracy: 71.301% | Epoch Time: 131.10 secs
2024-04-03 15:32:28,474 - INFO - Train Ended!
2024-04-03 15:32:28,474 - INFO - Saving train statistics
2024-04-03 15:32:28,674 - INFO - Save statistics done!
