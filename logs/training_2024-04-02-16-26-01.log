2024-04-02 16:26:01,846 - INFO - Args parsed succesfully
2024-04-02 16:26:01,846 - INFO - Params: Namespace(emotion_transform_prob=None, epochs=40, exp_name='Expanded_New_Transforms_No_Normalization', fine_tune=False, load_byol=False, net_name='dino_v2', use_expanded_dataset=True, verbose=False)
2024-04-02 16:26:02,123 - INFO - using MLP layer as FFN
2024-04-02 16:26:02,635 - INFO - Model was initialized and sent to cuda:0
2024-04-02 16:26:02,636 - INFO - EmotionNet(
  (nn_model): DinoVisionTransformer(
    (patch_embed): PatchEmbed(
      (proj): Conv2d(3, 384, kernel_size=(14, 14), stride=(14, 14))
      (norm): Identity()
    )
    (blocks): ModuleList(
      (0-11): 12 x NestedTensorBlock(
        (norm1): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
        (attn): MemEffAttention(
          (qkv): Linear(in_features=384, out_features=1152, bias=True)
          (attn_drop): Dropout(p=0.0, inplace=False)
          (proj): Linear(in_features=384, out_features=384, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
        )
        (ls1): LayerScale()
        (drop_path1): Identity()
        (norm2): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
        (mlp): Mlp(
          (fc1): Linear(in_features=384, out_features=1536, bias=True)
          (act): GELU(approximate='none')
          (fc2): Linear(in_features=1536, out_features=384, bias=True)
          (drop): Dropout(p=0.0, inplace=False)
        )
        (ls2): LayerScale()
        (drop_path2): Identity()
      )
    )
    (norm): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
    (head): Linear(in_features=384, out_features=7, bias=True)
  )
)
2024-04-02 16:26:05,910 - INFO - All data has been loaded
2024-04-02 16:26:05,912 - INFO - Got hyper parametrs for current model:
2024-04-02 16:26:05,912 - INFO - batch size=128
2024-04-02 16:26:05,912 - INFO - Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0002
    lr: 0.0002
    maximize: False
    weight_decay: 2e-05
)
2024-04-02 16:26:05,912 - INFO - <torch.optim.lr_scheduler.CosineAnnealingLR object at 0x7fbe03abcc10>
2024-04-02 16:26:05,912 - INFO - DataLoaders initialized
2024-04-02 16:26:05,913 - INFO - HyperParams initiliazed, starting training...
2024-04-02 16:32:44,899 - INFO - Epoch: 1 | Loss: 0.0118 | Validation accuracy: 44.218% | Epoch Time: 398.99 secs
2024-04-02 16:39:24,840 - INFO - Epoch: 2 | Loss: 0.0102 | Validation accuracy: 44.609% | Epoch Time: 399.74 secs
2024-04-02 16:46:33,073 - INFO - Epoch: 3 | Loss: 0.0099 | Validation accuracy: 45.472% | Epoch Time: 427.71 secs
2024-04-02 16:53:22,344 - INFO - Epoch: 4 | Loss: 0.0097 | Validation accuracy: 45.528% | Epoch Time: 408.68 secs
2024-04-02 17:07:02,551 - INFO - Epoch: 5 | Loss: 0.0096 | Training accuracy: 56.011% | Validation accuracy: 46.085% | Epoch Time: 819.61 secs
2024-04-02 17:13:43,476 - INFO - Epoch: 6 | Loss: 0.0095 | Validation accuracy: 46.392% | Epoch Time: 400.16 secs
2024-04-02 17:20:23,446 - INFO - Epoch: 7 | Loss: 0.0095 | Validation accuracy: 45.054% | Epoch Time: 399.37 secs
2024-04-02 17:27:13,288 - INFO - Epoch: 8 | Loss: 0.0094 | Validation accuracy: 45.751% | Epoch Time: 409.57 secs
2024-04-02 17:33:58,610 - INFO - Epoch: 9 | Loss: 0.0094 | Validation accuracy: 45.277% | Epoch Time: 405.02 secs
2024-04-02 17:47:27,896 - INFO - Epoch: 10 | Loss: 0.0093 | Training accuracy: 57.113% | Validation accuracy: 45.639% | Epoch Time: 808.98 secs
2024-04-02 17:54:15,554 - INFO - Epoch: 11 | Loss: 0.0093 | Validation accuracy: 45.138% | Epoch Time: 407.38 secs
2024-04-02 18:00:56,811 - INFO - Epoch: 12 | Loss: 0.0093 | Validation accuracy: 45.389% | Epoch Time: 400.96 secs
2024-04-02 18:07:37,619 - INFO - Epoch: 13 | Loss: 0.0093 | Validation accuracy: 45.528% | Epoch Time: 400.52 secs
2024-04-02 18:14:19,086 - INFO - Epoch: 14 | Loss: 0.0093 | Validation accuracy: 45.556% | Epoch Time: 401.19 secs
2024-04-02 18:27:33,835 - INFO - Epoch: 15 | Loss: 0.0093 | Training accuracy: 57.668% | Validation accuracy: 45.751% | Epoch Time: 794.44 secs
2024-04-02 18:34:15,177 - INFO - Epoch: 16 | Loss: 0.0093 | Validation accuracy: 45.584% | Epoch Time: 401.07 secs
2024-04-02 18:40:58,728 - INFO - Epoch: 17 | Loss: 0.0093 | Validation accuracy: 46.308% | Epoch Time: 403.28 secs
2024-04-02 18:47:45,172 - INFO - Epoch: 18 | Loss: 0.0093 | Validation accuracy: 46.085% | Epoch Time: 406.15 secs
2024-04-02 18:54:32,335 - INFO - Epoch: 19 | Loss: 0.0093 | Validation accuracy: 45.639% | Epoch Time: 406.88 secs
2024-04-02 19:07:46,817 - INFO - Epoch: 20 | Loss: 0.0092 | Training accuracy: 57.694% | Validation accuracy: 45.528% | Epoch Time: 794.21 secs
2024-04-02 19:14:29,873 - INFO - Epoch: 21 | Loss: 0.0092 | Validation accuracy: 45.584% | Epoch Time: 402.56 secs
2024-04-02 19:21:10,539 - INFO - Epoch: 22 | Loss: 0.0092 | Validation accuracy: 45.862% | Epoch Time: 400.39 secs
2024-04-02 19:27:49,626 - INFO - Epoch: 23 | Loss: 0.0092 | Validation accuracy: 46.113% | Epoch Time: 398.81 secs
2024-04-02 19:34:32,781 - INFO - Epoch: 24 | Loss: 0.0092 | Validation accuracy: 46.280% | Epoch Time: 402.66 secs
2024-04-02 19:47:47,576 - INFO - Epoch: 25 | Loss: 0.0092 | Training accuracy: 57.892% | Validation accuracy: 46.559% | Epoch Time: 794.52 secs
2024-04-02 19:54:29,091 - INFO - Epoch: 26 | Loss: 0.0092 | Validation accuracy: 46.030% | Epoch Time: 400.89 secs
2024-04-02 20:01:10,430 - INFO - Epoch: 27 | Loss: 0.0092 | Validation accuracy: 46.197% | Epoch Time: 401.05 secs
2024-04-02 20:07:51,563 - INFO - Epoch: 28 | Loss: 0.0092 | Validation accuracy: 46.280% | Epoch Time: 400.86 secs
2024-04-02 20:14:32,520 - INFO - Epoch: 29 | Loss: 0.0092 | Validation accuracy: 46.225% | Epoch Time: 400.68 secs
2024-04-02 20:27:45,768 - INFO - Epoch: 30 | Loss: 0.0092 | Training accuracy: 58.001% | Validation accuracy: 46.057% | Epoch Time: 792.96 secs
2024-04-02 20:34:26,366 - INFO - Epoch: 31 | Loss: 0.0092 | Validation accuracy: 46.169% | Epoch Time: 400.30 secs
2024-04-02 20:41:07,476 - INFO - Epoch: 32 | Loss: 0.0092 | Validation accuracy: 46.280% | Epoch Time: 400.77 secs
2024-04-02 20:47:48,266 - INFO - Epoch: 33 | Loss: 0.0092 | Validation accuracy: 46.113% | Epoch Time: 400.51 secs
2024-04-02 20:54:38,459 - INFO - Epoch: 34 | Loss: 0.0092 | Validation accuracy: 46.197% | Epoch Time: 409.91 secs
2024-04-02 21:07:58,494 - INFO - Epoch: 35 | Loss: 0.0092 | Training accuracy: 58.001% | Validation accuracy: 46.225% | Epoch Time: 799.73 secs
2024-04-02 21:14:42,966 - INFO - Epoch: 36 | Loss: 0.0092 | Validation accuracy: 46.336% | Epoch Time: 404.20 secs
2024-04-02 21:21:26,692 - INFO - Epoch: 37 | Loss: 0.0092 | Validation accuracy: 46.169% | Epoch Time: 403.45 secs
2024-04-02 21:28:11,846 - INFO - Epoch: 38 | Loss: 0.0092 | Validation accuracy: 46.141% | Epoch Time: 404.87 secs
2024-04-02 21:34:51,586 - INFO - Epoch: 39 | Loss: 0.0092 | Validation accuracy: 46.308% | Epoch Time: 399.45 secs
2024-04-02 21:48:09,150 - INFO - Epoch: 40 | Loss: 0.0092 | Training accuracy: 58.154% | Validation accuracy: 46.336% | Epoch Time: 797.29 secs
2024-04-02 21:48:09,566 - INFO - Train Ended!
2024-04-02 21:48:09,566 - INFO - Saving train statistics
2024-04-02 21:48:09,753 - INFO - Save statistics done!
